# 2022安全面试题问答

# 应用安全岗位（来源于https://www.yuque.com/feei/sig/application-security）

## 常规应用漏洞
### Redis未授权访问漏洞如何入侵利用
redis漏洞产生原因

(1) redis绑定在 0.0.0.0:6379，且没有进行添加防火墙规则避免其他非信任来源 ip 访问等相关安全策略，直接暴露在公网；

(2) 没有设置密码认证（一般为空），可以免密码远程登录redis服务。

(3) root 身份运行redis

redis利用方法

·能够回连且权限够的话，写crontab利用计划任务执行命令反弹shell

·开启22端口且权限够大的情况下，通过写公钥到服务器获得系统权限

·知道物理路径且web目录有写权限写webshell

·redis 4.x之后,主从复制getshell


### SSRF漏洞原理、利用方式及修复方案？Java和PHP的SSRF区别？

##### SSRF漏洞原理
原理：利用一个可以发起网络请求的服务，当作跳板来攻击其他服务。  

SSRF漏洞一般位于  
远程图片加载、图片或文章收藏功能、URL分享、通过URL在线翻译、转码等功能点处   

1、 分享：通过url地址分享网页内容

2、 转码：通过URL地址把原地址的网页内容调优使其适合手机屏幕浏览

3、 在线翻译：通过URL地址翻译对应文本的内容

4、 图片加载与下载：通过URL地址加载或下载图片

5、 图片、文章收藏功能

##### SSRF漏洞利用

1）CURL支持协议

2）利用file协议读取文件

3）利用dict协议查看端口开放

4）利用gopher协议反弹shell

##### SSRF漏洞利用绕过

* 使用@：http://A.com@10.10.10.10 = 10.10.10.10

* IP地址转换成十进制、八进制：127.0.0.1 = 2130706433

* 使用短地址：http://10.10.116.11 = http://t.cn/RwbLKDx

* 端口绕过：ip后面加一个端口

* xip.io：10.0.0.1.xip.io = 10.0.0.1

* 通过js跳转..

* 利用DNS解析

* 利用句号（127。0。0。1）

* 利用[::]（http://[::]:80/）；

* 利用短地址（http://dwz.cn/11SMa）；

* 协议（Dict://、SFTP://、TFTP://、LDAP://、Gopher://）

##### SSRF漏洞修复方式：

1、过滤返回信息，验证远程服务器对请求的响应是比较容易的方法；

2、统一错误信息，避免用户可以根据错误信息来判断远端服务器的端口状态；

3、限制请求的端口为http常用的端口，比如，80,443,8080,8090；

4、黑名单内网ip。避免应用被用来获取获取内网数据，攻击内网；

5、禁用不需要的协议。仅允许http和https请求；

6、使用正则对参数进行效验，防止畸形请求绕过黑名单。

7、禁止30x跳转

##### Java和PHP的SSRF区别
PHP支持的协议

·file:// — Accessing local filesystem  
·http:// — Accessing HTTP(s) URLs  
·ftp:// — Accessing FTP(s) URLs  
·php:// — Accessing various I/O streams  
·zlib:// — Compression Streams  
·data:// — Data (RFC 2397)  
·glob:// — Find pathnames matching pattern  
·phar:// — PHP Archive  
·ssh2:// — Secure Shell 2  
·rar:// — RAR  
·ogg:// — Audio streams  
·expect:// — Process Interaction Streams  

Java支持的协议  
·file  
·ftp  
·gopher  
·http  
·https  
·jar  
·mailto  
·netdoc  

### 宽字节注入漏洞原理、利用方式及修复方案？
gbk编码 %df  
使用mysql_set_charset(GBK)指定字符集


### 简述JSONP的业务意义，JSONP劫持利用方式及修复方案？如何设计落地一个CSRF Token？

##### 如何设计落地一个CSRF Token
在请求中添加一个攻击者不知道的参数（且该参数浏览器不会自动发送），让服务端可以区别出请求是否经过用户的同意。

这样用户知道该参数，发送请求的时候，携带 cookie 和该参数；而攻击者不知道该参数，浏览器发送请求时，只自动携带了 cookie。服务端即可通过校验该参数，来判断操作是否是用户真实想进行的。

这个参数，就被称为 csrf token。

HTTP request Header: 将 token 添加在 header 中发送，它具有一个天然的优势，可以利用浏览器的同源策略：csrf token header 相当于一个自定义 header，在跨域请求时，携带自定义 header，会触发预检请求，若预检请求不通过，正式请求就不会发送。

双重提交（Double Submit Cookie）

在请求到达服务端后，服务端不需要再从数据库/缓存中读取对应的值来跟 csrf token 比对。只需要跟请求中的 csrf cookie 比对即可。这个 cookie 就是服务端当初签发出去的 token 参数。只要它们相等，就证明请求是经过用户同意发送的，因为攻击者无法读取这个 cookie 值，也就无法将这个值作为 token 参数，添加到请求中发送，而用户是知道的（用户可以读取 csrf token cookie）。
我们可以使用加密签名的方式：
将用户的 session token 作为明文，使用服务端的密钥进行加密签名，将面名后的秘文作为 csrf token value 发送给客户端。使用  session token 作为明文有 2 个好处：即保证了 csrf token 跟 user 绑定，又保证了 csrf token 的随机且唯一。即：
csrf_token = HMAC(session_token, application_secret)

当服务端收到请求后，从缓存/数据库/cookie 中获取原来的加密明文 session_token，使用服务端的密钥再进行一次加密签名，比对签名后的结果 和 请求中携带的 csrf token 参数是否相等，若相等，则：
csrf token 是服务端签发的

签名的内容没有被篡改，即该 token 就是当前用户的。

### CORS原理、利用及修复？

### CRLF注入原理？

### URL白名单如何绕过？

### XSS持久化如何实现？

### Fastjson常见漏洞原理？如何彻底解决Fastjson漏洞？

## 业务逻辑漏洞


### 业务逻辑漏洞有哪些具体类型？提示：考察对业务逻辑的理解，如果只局限在越权则比较浅。凡是和业务比较贴近的漏洞都算业务逻辑漏洞，比如身份校验相关的风险（未授权访问、非正常账户态、身份可枚举、水平越权、垂直越权等）、接口逻辑实现不一致（不同协议实现不一致、同类产品不同逻辑、不同阶段逻辑不一致-流程绕过）、不安全的可信端数据（APP数据）、预设要求不符合（依赖条件不安全-业务校验属性设计、人工客服容易被骗-业务流程设计）、滥用合理业务需求等等。

### 哪些账户状态会导致预期外的风险？提示：此题考的是当账户状态改变时，由于各个业务逻辑并不一定严格遵循该账户状态的要求导致的还可以继续进行一些预期外的操作。一般账户状态在注销、禁用、风控、司法冻结等时候，会出现该问题。

### 身份标识明文传输会导致什么风险？提示：伪造他人身份态。

### 水平越权触发点会存在哪些位置？提示：Cookies、自定义Header、URL Path、URL Param Value、URL Param JSON、Body Form、Body JSON、Body XML、自定义协议的自定义字段等等。

### 水平越权有哪几种检测方式？提示：一般针对数字类型的越权可以通过递增枚举数字，根据响应情况可以判断是否存在越权。此外还可以通过两个账号相互访问对方创建的资源来判断，可避免不连续的数字导致的遗漏。

### 某个APP的某个功能按钮是灰色不可用状态，如何绕过其限制？提示：除了修改按钮属性使其可用或分析灰色功能对应的后端接口，直接调用接口外。如果能考虑到不同协议的实现可能不一致就更加全面了，比如APP上不能用，PC上是否就能用了，PC也不能用，通过各种协议（HTTP、WSDL、REST、GraphQL）的API调用是否能绕过。

### 流程绕过漏洞如何抽象理解归类？提示：流程绕过漏洞可以理解为不同阶段逻辑实现不一致，比如创建和后续状态变更时的要求不一致（一个操作创建时权限校验很严格，结果修改的时候的权限要求却不一致）、一个流程某个步骤的要求不一致（第一步要输入密码，结果第二部下单的时候并未强校验前面输密码是否完成）、并发逻辑控制（开多窗口同时支付，使一个优惠多次使用）、特殊时期的逻辑绕过（大促时期的校验机制降级）等等。常用协议漏洞

### TLS1.2协议交互过程以及攻击方法？

### 若对OAuth的redirect_uri进行了白名单限制，有哪些可能绕过的方式？

### JWT相较于SESSION优劣势？漏洞测试软性能力

### 哪些漏洞的测试对业务有损？如何避免？

### 你之前没接触区块链/云原生/算法安全，现在需要你评估某个使用该技术的业务安全性，你会如何做？漏洞处置

### 漏洞修复一般分为哪几个步骤？  

### 如何制定漏洞的修复时间？需要考虑哪些因素？

### 如何有效提升漏洞修复效率？

### 漏洞复盘的关键是什么？

### 如何快速有效推进修复外部厂商的漏洞？

### 外部白帽子发现某个高危漏洞，但完整修复需要多天，安全产品的止血手段不彻底，你该如何处置？漏洞自动化发现白盒SAST

### 当前阶段，人工和自动化的代码审计差异点在哪里？

### 什么类型漏洞是代码审计无法准确判断存在与否的？

### 密钥的识别的正则如何写？

### 正则(a+)+会存在什么风险？

### 程序对读取的文件名的正则为/\.markdown/，如何绕过？

### 程序对请求的URL的正则为/^http\:\/\/.*\.paipai.com($|(\/[^<>\'\"]*))/，如何绕过？       

### 解释型语言和编译型语言在语法树分析上有什么差异？

### Java Web应用中的反序列化漏洞的Source和Sink是什么？黑盒DAST

### 黑盒如何检测XSS漏洞？

### 甲方黑盒是否应该有爬取流量功能？

### 黑盒如何扫描无法出网的SSRF？

### 黑盒如何扫描越权漏洞？

### 黑盒带登录态扫描如何规避业务影响？

### 黑盒扫描时如何避免被反制？灰盒IAST

### 灰盒相较于黑白盒的优势是什么？安全评估与解决方案安全评估

### 安全评估到底要评什么东西？

### 某些场景（登录、注册、修改密码、支付）会存在哪些风险以及如何防范？

### 新应用如何评估安全风险？

### 需求阶段、系分阶段安全评估的侧重点是什么？

### 接口B的参数是从接口A的响应中获取的，会存在什么风险？

### 新的API接口上线时，如何设计使其避免出现请求篡改和请求重放？

### Docker容器以及K8s有哪些风险？

### IPv6和IPv4安全差异？

### 三方引入的应用和自研应用评估差异有哪些？

### 金融业务有何特色？

### mvn源的安全性需要考虑哪些点？

### 如何让业务方主动找你评估？

### 如何判断评估覆盖范围的优先级？

### 如何降低各人检验导致评估不一致？

### 如何系统提高安全评估效率？

### 安全评估和人工测试以及自动化测试三者差异是什么？

### 算法模型的安全风险如何评估？

### 区块链安全风险主要有哪些？

### 如何理解安全左移？

### 安全评估的行业最佳实践是什么？

### 如何看待未来安全评估的趋势？安全方案

### 如何规避绕口令带来的风险？

### 硬编码密钥如何系统解决？

### 0day漏洞如何防御

### GitHub等三方泄漏敏感信息如何体系防御

### 业务逻辑漏洞如何通过技术手段避免写出来？

### 软件供应链后门和漏洞如何系统规避移动应用安全

### App自检升级场景下会存在哪些风险？

### 如何设计一套通信机制，能够保证传输过程中的完整性、不可抵赖性以及防止重放？

### 如何进行实体检测？

### 常见的调试方法和检测方法？

### 如何防止Frida、Xposed等注入攻击？

### 如何防止当前设备的数据拷贝到其他设备？

### 外挂有几种类型的实现方式？

### 如何避免未经用户授权获取权限？
